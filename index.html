<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <title>Ø³Ø§Ù…Ø§Ù†Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø³ÛŒØ± Ùˆ Ù…Ø³Ø§ÙØª Ø­Ù…Ù„â€ŒÙˆÙ†Ù‚Ù„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    body {
      margin: 0;
      font-family: Tahoma, sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: #fff;
    }

    header {
      text-align: center;
      padding: 15px;
      font-size: 20px;
      font-weight: bold;
    }

    .layout {
      display: flex;
      height: calc(100vh - 60px);
    }

    .sidebar {
      width: 320px;
      background: rgba(0,0,0,0.4);
      padding: 15px;
      z-index: 2;
    }

    .sidebar h3 {
      margin-top: 0;
      font-size: 15px;
      border-bottom: 1px solid rgba(255,255,255,0.3);
      padding-bottom: 8px;
    }

    label {
      font-size: 13px;
      opacity: 0.9;
    }

    input, select {
      width: 100%;
      margin-top: 5px;
      margin-bottom: 10px;
      padding: 8px;
      border-radius: 6px;
      border: none;
      font-size: 13px;
    }

    button {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: none;
      background: linear-gradient(to right, #0072ff, #00c6ff);
      color: #fff;
      font-size: 14px;
      cursor: pointer;
    }

    #map {
      flex: 1;
      height: 100%;
      z-index: 1;
    }

    table {
      width: 100%;
      margin-top: 15px;
      border-collapse: collapse;
      font-size: 13px;
    }

    table th, table td {
      border: 1px solid rgba(255,255,255,0.3);
      padding: 6px;
      text-align: center;
    }

    table th {
      background: rgba(255,255,255,0.15);
    }
  </style>
</head>
<body>

<header>ğŸš› Ø³Ø§Ù…Ø§Ù†Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø³ÛŒØ± Ùˆ Ù…Ø³Ø§ÙØª Ø­Ù…Ù„â€ŒÙˆÙ†Ù‚Ù„</header>

<div class="layout">
  <div class="sidebar">
    <h3>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø³ÛŒØ±</h3>

    <label>Ù…Ø®ØªØµØ§Øª Ù…Ø¨Ø¯Ø§ (lat,lng)</label>
    <input id="origin" placeholder="Ù…Ø«Ø§Ù„: 35.6892,51.3890" />

    <label>Ù…Ø®ØªØµØ§Øª Ù…Ù‚ØµØ¯ (lat,lng)</label>
    <input id="destination" placeholder="Ù…Ø«Ø§Ù„: 36.2605,59.6168" />

    <label>Ù†ÙˆØ¹ Ù†Ø§ÙˆÚ¯Ø§Ù†</label>
    <select id="vehicle">
      <option value="car">ğŸš— Ø³ÙˆØ§Ø±ÛŒ</option>
      <option value="truck">ğŸš› Ú©Ø§Ù…ÛŒÙˆÙ†</option>
    </select>

    <button onclick="calculateRoutes()">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø³ÛŒØ±</button>

    <div id="results"></div>
  </div>

  <div id="map"></div>
</div>

<script>
  const map = L.map('map').setView([32.4279, 53.688], 5);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Â© OpenStreetMap'
  }).addTo(map);

  let markers = [];
  let routes = [];

  map.on('click', e => {
    if (markers.length === 2) {
      markers.forEach(m => map.removeLayer(m));
      routes.forEach(r => map.removeLayer(r));
      markers = [];
      routes = [];
    }

    const marker = L.marker(e.latlng).addTo(map);
    markers.push(marker);

    if (markers.length === 1) {
      origin.value = `${e.latlng.lat.toFixed(6)},${e.latlng.lng.toFixed(6)}`;
    }

    if (markers.length === 2) {
      destination.value = `${e.latlng.lat.toFixed(6)},${e.latlng.lng.toFixed(6)}`;
    }
  });

  function calculateRoutes() {
    if (!origin.value || !destination.value) {
      alert('Ù…Ø¨Ø¯Ø§ Ùˆ Ù…Ù‚ØµØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ ÛŒØ§ Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†');
      return;
    }

    routes.forEach(r => map.removeLayer(r));
    routes = [];

    const p1 = origin.value.split(',').map(Number);
    const p2 = destination.value.split(',').map(Number);

    const distances = [];

    for (let i = 0; i < 3; i++) {
      const offset = (Math.random() - 0.5) * 0.2;
      const poly = L.polyline([
        [p1[0], p1[1]],
        [p2[0] + offset, p2[1] + offset]
      ], { color: ['cyan','lime','orange'][i] }).addTo(map);

      routes.push(poly);

      const d = map.distance([p1[0], p1[1]], [p2[0], p2[1]]) / 1000;
      distances.push(d);
    }

    const avg = distances.reduce((a,b)=>a+b,0) / distances.length;

    results.innerHTML = `
      <table>
        <tr>
          <th>Ù…Ø³ÛŒØ±</th>
          <th>Ù…Ø³Ø§ÙØª (km)</th>
          <th>Ø±ÙØª Ùˆ Ø¨Ø±Ú¯Ø´Øª</th>
        </tr>
        ${distances.map((d,i)=>`
          <tr>
            <td>Ù…Ø³ÛŒØ± ${i+1}</td>
            <td>${d.toFixed(2)}</td>
            <td>${(d*2).toFixed(2)}</td>
          </tr>`).join('')}
        <tr>
          <th>Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†</th>
          <th>${avg.toFixed(2)}</th>
          <th>${(avg*2).toFixed(2)}</th>
        </tr>
      </table>`;
  }
</script>

</body>
</html>
